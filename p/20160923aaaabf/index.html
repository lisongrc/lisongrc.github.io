<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="今天这篇我们将讲解子表达式和后向引用的使用。后面会持续更新。 理解子表达式 通过(和)括起来的就是子表达式。 下面是一个例子：用来匹配IP 地址的正"><title>系统地学习正则表达式(二)：进阶篇</title><link rel=canonical href=https://lisongrc.github.io/p/20160923aaaabf/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="系统地学习正则表达式(二)：进阶篇"><meta property="og:description" content="今天这篇我们将讲解子表达式和后向引用的使用。后面会持续更新。 理解子表达式 通过(和)括起来的就是子表达式。 下面是一个例子：用来匹配IP 地址的正"><meta property="og:url" content="https://lisongrc.github.io/p/20160923aaaabf/"><meta property="og:site_name" content="小松哥的博客"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="regular"><meta property="article:published_time" content="2016-09-26T23:41:42+00:00"><meta property="article:modified_time" content="2016-09-26T23:41:42+00:00"><meta name=twitter:title content="系统地学习正则表达式(二)：进阶篇"><meta name=twitter:description content="今天这篇我们将讲解子表达式和后向引用的使用。后面会持续更新。 理解子表达式 通过(和)括起来的就是子表达式。 下面是一个例子：用来匹配IP 地址的正"><meta name=referrer content="no-referrer"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu66761f67689d09650ff2d1e3069c4103_356268_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>😎</span></figure><div class=site-meta><h1 class=site-name><a href=/>小松哥的博客</a></h1><h2 class=site-description>是缘是情是童真还是意外</h2></div></header><ol class=social-menu><li><a href=https://github.com/lisongrc target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>主页</span></a></li><li><a href=/%E5%85%B3%E4%BA%8E/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>关于</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#nspredicate>NSPredicate</a></li><li><a href=#nsstring>NSString</a></li><li><a href=#nsregularexpression>NSRegularExpression</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/ios/>iOS</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/20160923aaaabf/>系统地学习正则表达式(二)：进阶篇</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Sep 26, 2016</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 10 分钟</time></div></footer></div></header><section class=article-content><p>今天这篇我们将讲解<code>子表达式</code>和<code>后向引用</code>的使用。后面会持续更新。</p><h1 id=理解子表达式>理解子表达式</h1><p>通过<code>(</code>和<code>)</code>括起来的就是子表达式。</p><p>下面是一个例子：用来匹配IP 地址的正则表达式。 IP 地址是由" . &ldquo;分隔的四组数字，如12.159.46.200。因为每个部分的数字都可以为一个、两个或者三个数字字符，这个匹配模式可以表示为<code>\d{1,3}</code>：</p><blockquote><p>正则表达式：<code>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}</code>
待匹配文本：12.159.46.200
匹配后结果：<code>12.159.46.200</code></p></blockquote><p>分析：每个<code>\d{1,3}</code>的实例都匹配了 IP 地址的一个数字。四个数字则是被<code> \. </code>表示的&rdquo; . &ldquo;分隔开的。<code>\d{1,3}\.</code>模式重复了三遍，因此可以使用重复操作来处理。下面是相同例子的另外一个版本：</p><blockquote><p>正则表达式：<code>(\d{1,3}\.){3}\d{1,3}</code>
待匹配文本：12.159.46.200
匹配后结果：<code>12.159.46.200</code></p></blockquote><p>分析：此模式可以和前面的效果是一样的。表达式<code>\d{1,3}\. </code>使用<code>(</code>和<code>)</code>括起来从而组成子表达式。<code>(\d{1,3}\.){3}</code>重复了子表达式三次（也就是 IP 地址的前三个数字），最后的<code>\d{1,3}</code>匹配最后的数字。</p><p>使用子表达式来分组是很重要的，尽管这个例子中根本不包括重复。来看一个例子：</p><blockquote><p>正则表达式：<code>19|20\d{2}</code>
待匹配文本：1967-08-17
匹配后结果：<code>19</code>67-08-17</p></blockquote><p>分析：<code>19|20\d{2}</code>用来定位一个<code>前两个数字只能为 19或者20 </code>的四位数的年份。但是很显然这个正则并没有实现预想的效果。<code>|</code>操作符从左到右读取，将<code>19|20\d{2}</code>分析为要么<code>19</code> ，要么<code>20\d{2}</code>，也就是匹配数字 <code>19</code> 或者<code>20开头的四个数字字符</code>。</p><p>解决方法是将<code>19|20</code>作为一个子表达式，<code>(19|20)\d{2}</code>就能够匹配所有19 和 20 开头的四个数字了。</p><h1 id=嵌套子表达式>嵌套子表达式</h1><p>子表达式可以嵌套。实际上，子表达式可以一层一层嵌套在子表达式内。为了演示嵌套子表达式的用法，我们再来看看查找 IP 地址的例子。</p><p>其实上面例子中<code>(\d{1,3}\.){3}\d{1,3}</code>匹配IP 地址是有问题的，因为非法的 IP 地址也将被匹配。IP 地址中的每个数字都是小于 255 的。而上面的模式可以匹配 300甚至是999 ，而这些实际上都是非法的 IP 地址。</p><p>下面定义了所有合法 IP 地址所需要满足的一种条件：</p><blockquote><p>所有的一位数和两位数
三位数的第一位为 1
如果三位数的第一位为 2 ，且第二位从 0 到 4
如果三位数的前二位为 25 ，且第三位从 0 到 5</p></blockquote><p>当定义了需要匹配的情况后，就比较容易实现可以工作的模式。下面是个例子：
<code>(((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5]))\.){3}((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5]))</code></p><p>分析：这个模式可以工作的原因是一系列的嵌套子表达式。首先从<code>(((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5]))\.)</code>子表达式开始。包含了四个嵌套子表达式。<code>(\d{1,2})</code>可以匹配一位数和两位数(0到99)。<code>(1\d{2})</code>匹配了任何第一位为 1 的三位数(100到199) 。<code>(2[0-4]\d)</code>匹配数字从 200 到 249 。<code>(25[0-5])</code>匹配数字从 250 到 255 。每个子表达式都是通过“ | ”包括在另一个子表达式中。在数字范围之后是<code>\.</code>表示的&rdquo; . &ldquo;，然后这个系列括起来作为子表达式并重复三遍（使用<code>{3}</code>）。最后，<code>((\d{1,2})|(1\d{2})|(2[0-4]\d)|(25[0-5]))</code>被用来匹配最后一个 IP 地址的数字（没有了<code>\.</code>后缀）。由于将四个数字都是限制在了 0 到 255 之间，所以此模式可以匹配所有的合法 IP 地址。</p><h1 id=理解后向引用>理解后向引用</h1><p>HTML 开发者经常使用标题标签（<h1>到<h6>，包括相应的结束标签</h1>到</h6>）。假设你需要定位所有的标题标签：</p><blockquote><p>正则表达式：<code>&lt;[hH][1-6]>.*?&lt;/[hH][1-6]></code>
待匹配文本：<h1>title 1</h1>—<h6>title 6</h6>匹配后结果：<code>&lt;H1>title 1&lt;/H1></code> — <code>&lt;H6>title 6&lt;/H6></code></p></blockquote><p>分析：<code>&lt;[hH][1-6]></code>可以匹配所有的开始标签，而<code>&lt;/[hH][1-6]></code>可以匹配所有的结束标签。</p><p>注意：我们这里使用了<code>.*?</code>而不是<code>.*</code>。正如在上一篇文章解释的一样，<code>*</code>的量词是贪婪的，所以模式<code>&lt;[hH][1-6]>.*&lt;/[hH][1-6]></code>将匹配从<h1> 直到 </h6> 。所以可以使用非贪婪量词<code>.*?</code>来解决这个问题。</p><p>接着看这个例子：</p><blockquote><p>正则表达式：<code>&lt;[hH][1-6]>.*?&lt;/[hH][1-6]></code>
待匹配文本：<h1>title</h6>匹配后结果：<code>&lt;H1>title&lt;/H6></code></p></blockquote><p>分析：采用 <h1> 开始而采用 </h6> 的标题标签是非法的，但是现在的模式可以匹配。问题在于匹配的第二个部分（匹配结束的标签）没有办法知道匹配第一部分（匹配开始的标签）是什么。这时候就需要后向引用了。</p><h1 id=使用后向引用匹配>使用后向引用匹配</h1><p><code>后向应用</code>就是引用前面的子表达式。你可以将后向应用理解成变量。例如<code>\1</code>匹配模式中第一个子表达式。同理，<code>\2</code>将匹配第二个子表达式，<code>\3</code>将匹配第三个。我们结合例子来理解。一个子表达式可以通过后向引用根据需要引用多次。</p><p>在上个例子中，<code>&lt;[hH][1-6]>.*?&lt;/[hH][1-6]></code>会匹配非法的标题。我们可以使用后向引用来解决：</p><blockquote><p>正则表达式：<code>&lt;[hH]([1-6])>.*?&lt;/[hH]\1></code>
待匹配文本：<h1>title</h1>—<h1>title</h6>匹配后结果：<code>&lt;H1>title&lt;/H1></code>—<h1>title</h6></p></blockquote><p>分析：就像以前一样，<code>&lt;[hH]([1-6])></code>将匹配任何的标题标签。但是和以前不一样的是，这里的<code>[1-6] </code>使用了小括号括起来成为了子表达式。这样，匹配结束标签的模式可以通过<code>&lt;/[hH]\1></code>中的<code>\1</code>来引用此子表达式。<code>(1-6)</code>是一个可以匹配数字 1 到 6 的子表达式，<code>\1</code>因此可以匹配相同的数字。在这种情况下，"<h1>title</h6>&ldquo;将不能匹配。</p><p>注意：后向引用只能够引用子表达式（需要使用小括号括起来），后向引用语法在不同的正则表达式实现中可能是不一样的。引用的匹配一般是从 1 开始。在大多数的正则表达式实现中，0 可以用来引用整个表达式。</p><h1 id=执行替换操作>执行替换操作</h1><p>到现在为止我们所看到的正则表达式都是进行搜索，在一段文本中定位单词。正则表达式还可以用来执行替换操作。举个例子，将CA 替换成California和将MI替换成Michigan 并不是正则表达式需要完成的工作。尽管使用正则表达式也是合法的，但是没有必要这么做。事实上，在这里如果使用简单的字符串操作函数的话过程将会变得更加容易。</p><p>让我们来看一个例子，将<code>313-555-1234</code>格式的电话号码重新格式化为<code>(313) 555-1234</code>格式：</p><blockquote><p>查找表达式：<code>(\d{3})(-)(\d{3})(-)(\d{4})</code>
替换表达式：<code>($1) $3-$5</code></p><p>文本
313-555-1234
248-555-9999</p></blockquote><blockquote><p>结果
(313) 555-1234
(248) 555-9999</p></blockquote><p>分析：<code>(\d{3})(-)(\d{3})(-)(\d{4})</code>匹配了一个电话号码，并分成了五个子表达式。<code>(\d{3})</code>匹配刚开始的三个数字并作为第一个子表达式，<code>(-)</code>匹配&rdquo; - &ldquo;并作为第二个子表达式，依此类推。这五个部分可以根据需要单独引用，<code>($1) $3-$5</code>只是使用了其中的三个子表达式。因此“313-555-1234”改变为了“(313) 555-1234”。</p><h1 id=在xcode中查找和替换文本>在Xcode中查找和替换文本：</h1><p><strong>查找</strong>
<img src=http://upload-images.jianshu.io/upload_images/1608265-131169344bb76da1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240 loading=lazy alt=查找></p><p><strong>替换</strong>
<img src=http://upload-images.jianshu.io/upload_images/1608265-1e294c9c99b5977b.gif?imageMogr2/auto-orient/strip loading=lazy alt=替换></p><p>其实正则表达式还是很简单的，大家可以多找些例子熟悉一下。用的多了就熟了。</p><h1 id=正则表达式在ios中的使用>正则表达式在iOS中的使用。</h1><h2 id=nspredicate>NSPredicate</h2><p>NSPredicate通常用来验证一个字符串是不是符合某种格式，例如验证一个字符串是不是由数字和字母组成的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objc data-lang=objc><span class=line><span class=cl><span class=c1>//待匹配字符串
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSString</span> <span class=o>*</span><span class=n>string</span> <span class=o>=</span> <span class=s>@&#34;song123&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//正则表达式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSString</span> <span class=o>*</span><span class=n>regex</span> <span class=o>=</span> <span class=s>@&#34;^[a-z0－9A-Z]*$&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//创建predicate
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSPredicate</span> <span class=o>*</span><span class=n>predicate</span> <span class=o>=</span> <span class=p>[</span><span class=n>NSPredicate</span> <span class=nl>predicateWithFormat</span><span class=p>:</span><span class=s>@&#34;SELF MATCHES %@&#34;</span><span class=p>,</span> <span class=n>regex</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=c1>//用predicate匹配string。result为匹配结果，YES or NO。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>BOOL</span> <span class=n>result</span> <span class=o>=</span> <span class=p>[</span><span class=n>predicate</span> <span class=nl>evaluateWithObject</span><span class=p>:</span><span class=n>string</span><span class=p>];</span>
</span></span></code></pre></div><p>关于NSPredicate还有一些其他的可以使用方法们，具体可以查看官方API。</p><h2 id=nsstring>NSString</h2><p>NSString可以用正则来查找自己当中符合要求的子字符串，例如查找字符串中的数字：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objc data-lang=objc><span class=line><span class=cl><span class=c1>//待匹配字符串
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSString</span> <span class=o>*</span><span class=n>string</span> <span class=o>=</span> <span class=s>@&#34;song123&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//使用正则\d+去string中进行匹配，得到的时匹配到的range，在这里为{4，3}。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSRange</span> <span class=n>range</span> <span class=o>=</span> <span class=p>[</span><span class=n>string</span> <span class=nl>rangeOfString</span><span class=p>:</span><span class=s>@&#34;</span><span class=se>\\</span><span class=s>d+&#34;</span> <span class=nl>options</span><span class=p>:</span><span class=n>NSRegularExpressionSearch</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=c1>//如果匹配到就打印匹配到的子字符串，在这里为123。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=n>range</span><span class=p>.</span><span class=n>location</span> <span class=o>!=</span> <span class=n>NSNotFound</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=n>NSLog</span><span class=p>(</span><span class=s>@&#34;%@&#34;</span><span class=p>,[</span><span class=n>string</span> <span class=nl>substringWithRange</span><span class=p>:</span><span class=n>range</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>分析：<code>\d+</code>用来查找数字，<code>rangeOfString:options:</code>会返回一个NSRange，用来接收匹配的范围。<code>options</code>必须要用<code>NSRegularExpressionSearch</code>，代表用正则去匹配。<code>range.location==NSNotFound</code>的话代表匹配不到结果。当写正则字符串时，<code>\\ </code>需要写成<code>\\\\</code> ，所以，<code>\d+</code>需要写成<code>\\\\d+</code>。</p><h2 id=nsregularexpression>NSRegularExpression</h2><p>对于匹配字符串中的数字，我们也可以用到NSRegularExpression这个类实现。它可以用户来查找字符串中符合要求的<code>第一个匹配结果</code>或者<code>所有匹配结果</code>。</p><p><strong>查找字符串中第一个匹配结果</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objc data-lang=objc><span class=line><span class=cl><span class=c1>//待匹配字符串
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSString</span> <span class=o>*</span><span class=n>string</span> <span class=o>=</span> <span class=s>@&#34;123abc45fgt7tyu&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//正则表达式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSString</span> <span class=o>*</span><span class=n>pattern</span> <span class=o>=</span> <span class=s>@&#34;</span><span class=se>\\</span><span class=s>d+&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//创建NSRegularExpression对象并指定正则表达式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSRegularExpression</span> <span class=o>*</span><span class=n>regex</span> <span class=o>=</span> <span class=p>[</span><span class=n>NSRegularExpression</span> <span class=nl>regularExpressionWithPattern</span><span class=p>:</span><span class=n>pattern</span>
</span></span><span class=line><span class=cl><span class=err>  </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>options</span><span class=p>:</span><span class=n>NSRegularExpressionCaseInsensitive</span>
</span></span><span class=line><span class=cl><span class=err>  </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>error</span><span class=p>:</span><span class=nb>nil</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=c1>//查找第一个匹配结果，如果查找不到的话match会是nil
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSTextCheckingResult</span> <span class=o>*</span><span class=n>match</span> <span class=o>=</span> <span class=p>[</span><span class=n>regex</span> <span class=nl>firstMatchInString</span><span class=p>:</span><span class=n>string</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>options</span><span class=p>:</span><span class=n>NSMatchingReportCompletion</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>range</span><span class=p>:</span><span class=n>NSMakeRange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=p>[</span><span class=n>string</span> <span class=n>length</span><span class=p>])];</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>match</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=c1>//如果查找到就打印出来，结果为123
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err> </span> <span class=err> </span> <span class=n>NSLog</span><span class=p>(</span><span class=s>@&#34;%@&#34;</span><span class=p>,[</span><span class=n>string</span> <span class=nl>substringWithRange</span><span class=p>:</span><span class=n>match</span><span class=p>.</span><span class=n>range</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>分析：<code>firstMatchInString:options:range</code>会查找字符串中第一个匹配，所以<code>123abc45fgt7tyu</code>的匹配结果为<code>123</code>。</p><p><strong>查找字符串中所有匹配结果</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objc data-lang=objc><span class=line><span class=cl><span class=c1>//待匹配字符串
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSString</span> <span class=o>*</span><span class=n>string</span> <span class=o>=</span> <span class=s>@&#34;123abc45fgt7tyu&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//正则表达式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSString</span> <span class=o>*</span><span class=n>pattern</span> <span class=o>=</span> <span class=s>@&#34;</span><span class=se>\\</span><span class=s>d+&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>//创建NSRegularExpression对象并指定正则表达式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSRegularExpression</span> <span class=o>*</span><span class=n>regex</span> <span class=o>=</span> <span class=p>[</span><span class=n>NSRegularExpression</span> <span class=nl>regularExpressionWithPattern</span><span class=p>:</span><span class=n>pattern</span>
</span></span><span class=line><span class=cl><span class=err>  </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>options</span><span class=p>:</span><span class=n>NSRegularExpressionCaseInsensitive</span>
</span></span><span class=line><span class=cl><span class=err>  </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>error</span><span class=p>:</span><span class=nb>nil</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=c1>//查找所有匹配结果
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>NSArray</span><span class=o>*</span> <span class=n>matches</span> <span class=o>=</span> <span class=p>[</span><span class=n>regex</span> <span class=nl>matchesInString</span><span class=p>:</span><span class=n>string</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>options</span><span class=p>:</span><span class=n>NSMatchingReportProgress</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=nl>range</span><span class=p>:</span><span class=n>NSMakeRange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=p>[</span><span class=n>string</span> <span class=n>length</span><span class=p>])];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//如果有匹配就打印出来，结果为123 45 7
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=n>matches</span><span class=p>.</span><span class=n>count</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=k>for</span> <span class=p>(</span><span class=n>NSTextCheckingResult</span> <span class=o>*</span><span class=n>match</span> <span class=k>in</span> <span class=n>matches</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=n>NSLog</span><span class=p>(</span><span class=s>@&#34;%@&#34;</span><span class=p>,[</span><span class=n>string</span> <span class=nl>substringWithRange</span><span class=p>:</span><span class=n>match</span><span class=p>.</span><span class=n>range</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>分析：<code>matchesInString:options:range:</code>会查找字符串中的所有匹配，结果是一个包含<code>NSTextCheckingResult</code>的数组。所以<code>123abc45fgt7tyu</code>的匹配结果为<code>123</code>、<code>45</code>和<code>7</code>。</p><p>创建<code>NSRegularExpression</code>对象时的<code>options</code>参数为<code>NSRegularExpressionOptions</code>类型，可选值以及代表的意义如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objc data-lang=objc><span class=line><span class=cl><span class=k>typedef</span> <span class=nf>NS_OPTIONS</span><span class=p>(</span><span class=n>NSUInteger</span><span class=p>,</span> <span class=n>NSRegularExpressionOptions</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=err> </span> <span class=err> </span> <span class=n>NSRegularExpressionCaseInsensitive</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>,</span><span class=err> </span> <span class=c1>//不区分大小写
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err> </span> <span class=err> </span> <span class=n>NSRegularExpressionAllowCommentsAndWhitespace</span><span class=err> </span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>,</span><span class=err> </span> <span class=c1>//忽略空白和注释
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err> </span> <span class=err> </span> <span class=n>NSRegularExpressionIgnoreMetacharacters</span><span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>,</span><span class=err> </span> <span class=c1>//将所有的patter当作普通字符串
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err> </span> <span class=err> </span> <span class=n>NSRegularExpressionDotMatchesLineSeparators</span><span class=err> </span> <span class=err> </span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span><span class=p>,</span><span class=err> </span> <span class=c1>// 允许.匹配所有字符
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err> </span> <span class=err> </span> <span class=n>NSRegularExpressionAnchorsMatchLines</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>,</span><span class=err> </span> <span class=c1>// 允许^,$匹配每一行的开头和结尾
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err> </span> <span class=err> </span> <span class=n>NSRegularExpressionUseUnixLineSeparators</span> <span class=err> </span> <span class=err> </span> <span class=err> </span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>5</span><span class=p>,</span><span class=err> </span> <span class=c1>// 只把\n识别为换行符
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err> </span> <span class=err> </span> <span class=n>NSRegularExpressionUseUnicodeWordBoundaries</span><span class=err> </span> <span class=err> </span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>6</span> <span class=err> </span> <span class=c1>// 使用 Unicode TR#29 规定的边界，否则，使用传统的正则表达式的词边界
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></div><p>关于NSRegularExpression还有一些其他的可以使用方法们，具体可以查看<a class=link href="https://developer.apple.com/reference/foundation/nsregularexpression?language=objc" target=_blank rel=noopener>这里</a>。</p><h1 id=一些常用的正则>一些常用的正则：</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>邮箱：^[a-zA-Z0-9]{4,}@[a-z0-9A-Z]{2,}\\.[a-zA-Z]{2,}$
</span></span><span class=line><span class=cl>手机号码：^((13[0-9])|(15[^4\\D])|(18[0,2,5-9]))\\d{8}$
</span></span><span class=line><span class=cl>大陆固定电话号码：^\\d{4}-|\\d{3}-)?(\\d{8}|\\d{7}$
</span></span><span class=line><span class=cl>身份证号：\\d{14}[[0-9],0-9xX]
</span></span><span class=line><span class=cl>Email地址：^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\.\\w+([-.]\\w+)*$
</span></span><span class=line><span class=cl>纯数字：^[0-9]*$
</span></span><span class=line><span class=cl>由数字和英文字母组成：^[A-Za-z0-9]+$
</span></span><span class=line><span class=cl>QQ号：^[1-9][0-9]\{4,\}$
</span></span><span class=line><span class=cl>中国邮政编码：^[1-9]\\d{5}(?!\\d)$
</span></span><span class=line><span class=cl>URL：^http(s)?://([\\w-]+\\.)+[\\w-]+(/[\\w- ./?%&amp;=]*)?$
</span></span><span class=line><span class=cl>纯汉字：^[\u4e00-\u9fa5]{0,}$
</span></span></code></pre></div></section><footer class=article-footer><section class=article-tags><a href=/tags/regular/>regular</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/201609835121d0/><div class=article-details><h2 class=article-title>系统地学习正则表达式(一)：基础篇</h2></div></a></article><article><a href=/p/202104d0a1724/><div class=article-details><h2 class=article-title>iOS开发常用的效率工具，持续更新</h2></div></a></article><article><a href=/p/2021034535997/><div class=article-details><h2 class=article-title>Xcode好用的快捷键</h2></div></a></article><article><a href=/p/2019035053e96d/><div class=article-details><h2 class=article-title>iOSer都要知道的LLDB介绍与Chisel进阶</h2></div></a></article><article><a href=/p/201805784ea6a5/><div class=article-details><h2 class=article-title>iOS中@功能的完整实现</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2016 -
2023 小松哥的博客</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>